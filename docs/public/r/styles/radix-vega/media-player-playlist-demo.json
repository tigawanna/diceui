{
  "name": "media-player-playlist-demo",
  "dependencies": [
    "lucide-react",
    "media-chrome"
  ],
  "registryDependencies": [
    "button",
    "media-player",
    "scroll-area"
  ],
  "files": [
    {
      "path": "examples/media-player-playlist-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport {\r\n  ListMusicIcon,\r\n  Loader2Icon,\r\n  PauseCircleIcon,\r\n  PlayCircleIcon,\r\n  SkipBackIcon,\r\n  SkipForwardIcon,\r\n} from \"lucide-react\";\r\nimport * as React from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport {\r\n  MediaPlayer,\r\n  MediaPlayerAudio,\r\n  MediaPlayerControls,\r\n  MediaPlayerPlay,\r\n  MediaPlayerSeek,\r\n  MediaPlayerTime,\r\n  MediaPlayerTooltip,\r\n  MediaPlayerVolume,\r\n} from \"@/registry/bases/radix/ui/media-player\";\r\n\r\ninterface Track {\r\n  id: string;\r\n  title: string;\r\n  artist: string;\r\n  src: string;\r\n  cover: string;\r\n}\r\n\r\nconst tracks: Track[] = [\r\n  {\r\n    id: \"1\",\r\n    title: \"Medieval: Battle\",\r\n    artist: \"RandomMind\",\r\n    src: \"https://opengameart.org/sites/default/files/battle.mp3\",\r\n    cover: \"https://picsum.photos/seed/battle/200/200\",\r\n  },\r\n  {\r\n    id: \"2\",\r\n    title: \"City Lights\",\r\n    artist: \"The Lemming Shepherds\",\r\n    src: \"https://www.dropbox.com/s/mvvwaw1msplnteq/City%20Lights%20-%20The%20Lemming%20Shepherds.mp3?raw=1\",\r\n    cover: \"https://picsum.photos/seed/citylights/200/200\",\r\n  },\r\n];\r\n\r\nexport default function MediaPlayerPlaylistDemo() {\r\n  const [currentTrackIndex, setCurrentTrackIndex] = React.useState(0);\r\n  const [isPlaying, setIsPlaying] = React.useState(false);\r\n  const [isLoading, setIsLoading] = React.useState(false);\r\n  const audioRef = React.useRef<HTMLAudioElement | null>(null);\r\n  const shouldPlayAfterLoad = React.useRef(false);\r\n\r\n  const onPlay = React.useCallback(() => {\r\n    setIsPlaying(true);\r\n  }, []);\r\n\r\n  const onPause = React.useCallback(() => {\r\n    setIsPlaying(false);\r\n  }, []);\r\n\r\n  const onLoadAndPlayTrack = React.useCallback(\r\n    async (index: number, shouldPlay = true) => {\r\n      const trackToPlay = tracks[index];\r\n      if (!trackToPlay) {\r\n        toast.error(\"Track not found\");\r\n        return;\r\n      }\r\n\r\n      if (!audioRef.current) return;\r\n\r\n      if (!audioRef.current.paused) {\r\n        audioRef.current.pause();\r\n      }\r\n\r\n      setCurrentTrackIndex(index);\r\n      setIsLoading(true);\r\n      shouldPlayAfterLoad.current = shouldPlay;\r\n\r\n      audioRef.current.src = trackToPlay.src;\r\n      audioRef.current.load();\r\n    },\r\n    [],\r\n  );\r\n\r\n  const onPlayTrack = React.useCallback(\r\n    (index: number) => {\r\n      onLoadAndPlayTrack(index, true);\r\n    },\r\n    [onLoadAndPlayTrack],\r\n  );\r\n\r\n  const onPreviousTrack = React.useCallback(() => {\r\n    const prevIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;\r\n    onPlayTrack(prevIndex);\r\n  }, [currentTrackIndex, onPlayTrack]);\r\n\r\n  const onNextTrack = React.useCallback(() => {\r\n    const nextIndex = (currentTrackIndex + 1) % tracks.length;\r\n    onPlayTrack(nextIndex);\r\n  }, [currentTrackIndex, onPlayTrack]);\r\n\r\n  const onEnded = React.useCallback(() => {\r\n    onNextTrack();\r\n  }, [onNextTrack]);\r\n\r\n  const onAudioPlay = React.useCallback(async () => {\r\n    if (!audioRef.current) return;\r\n\r\n    try {\r\n      await audioRef.current.play();\r\n      setIsPlaying(true);\r\n    } catch (error) {\r\n      toast.error(\r\n        error instanceof Error ? error.message : \"Failed to play track\",\r\n      );\r\n      setIsPlaying(false);\r\n    }\r\n  }, []);\r\n\r\n  const onTogglePlayPauseTrack = React.useCallback(\r\n    (index: number) => {\r\n      if (index === currentTrackIndex) {\r\n        if (isPlaying) {\r\n          audioRef.current?.pause();\r\n        } else {\r\n          onAudioPlay();\r\n        }\r\n      } else {\r\n        onPlayTrack(index);\r\n      }\r\n    },\r\n    [currentTrackIndex, isPlaying, onAudioPlay, onPlayTrack],\r\n  );\r\n\r\n  const currentTrack = React.useMemo(\r\n    () => tracks[currentTrackIndex],\r\n    [currentTrackIndex],\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    const audioElement = audioRef.current;\r\n    if (!audioElement) return;\r\n\r\n    const onCanPlay = () => {\r\n      setIsLoading(false);\r\n      if (shouldPlayAfterLoad.current) {\r\n        onAudioPlay();\r\n        shouldPlayAfterLoad.current = false;\r\n      }\r\n    };\r\n\r\n    const onLoadStart = () => {\r\n      setIsLoading(true);\r\n    };\r\n\r\n    const onError = () => {\r\n      setIsLoading(false);\r\n      setIsPlaying(false);\r\n      toast.error(\"Failed to load track\");\r\n    };\r\n\r\n    audioElement.addEventListener(\"canplay\", onCanPlay);\r\n    audioElement.addEventListener(\"loadstart\", onLoadStart);\r\n    audioElement.addEventListener(\"error\", onError);\r\n\r\n    return () => {\r\n      audioElement.removeEventListener(\"canplay\", onCanPlay);\r\n      audioElement.removeEventListener(\"loadstart\", onLoadStart);\r\n      audioElement.removeEventListener(\"error\", onError);\r\n    };\r\n  }, [onAudioPlay]);\r\n\r\n  React.useEffect(() => {\r\n    if (\r\n      audioRef.current &&\r\n      currentTrack &&\r\n      audioRef.current.src !== currentTrack.src\r\n    ) {\r\n      onLoadAndPlayTrack(currentTrackIndex, false);\r\n    }\r\n  }, [currentTrack, currentTrackIndex, onLoadAndPlayTrack]);\r\n\r\n  const onKeyDown = React.useCallback(\r\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n      const isMediaFocused = event.currentTarget.contains(\r\n        document.activeElement,\r\n      );\r\n\r\n      if (!isMediaFocused) return;\r\n\r\n      switch (event.key.toLowerCase()) {\r\n        case \"n\":\r\n          event.preventDefault();\r\n          onNextTrack();\r\n          break;\r\n\r\n        case \"p\":\r\n          event.preventDefault();\r\n          onPreviousTrack();\r\n          break;\r\n      }\r\n    },\r\n    [onNextTrack, onPreviousTrack],\r\n  );\r\n\r\n  if (!currentTrack) return null;\r\n\r\n  return (\r\n    <MediaPlayer\r\n      onPlay={onPlay}\r\n      onPause={onPause}\r\n      onEnded={onEnded}\r\n      onKeyDown={onKeyDown}\r\n      className=\"w-full max-w-2xl overflow-hidden rounded-lg border bg-background shadow-lg\"\r\n    >\r\n      <MediaPlayerAudio\r\n        ref={audioRef}\r\n        src={currentTrack.src}\r\n        className=\"sr-only\"\r\n      />\r\n      <div className=\"flex w-full flex-col items-center gap-4 md:items-start\">\r\n        <div className=\"relative w-full overflow-hidden rounded-md rounded-b-none border-b\">\r\n          {/* biome-ignore lint/performance/noImgElement: dynamic cover URLs from playlist tracks don't work well with Next.js Image optimization */}\r\n          <img\r\n            src={currentTrack.cover}\r\n            alt={currentTrack.title}\r\n            className=\"h-40 w-full object-cover\"\r\n          />\r\n          <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent\" />\r\n          <div className=\"absolute right-0 bottom-0 left-0 p-4\">\r\n            <h2 className=\"font-semibold text-2xl text-white tracking-tight drop-shadow-lg\">\r\n              {currentTrack.title}\r\n            </h2>\r\n            <p className=\"text-sm text-white/90 drop-shadow-md\">\r\n              {currentTrack.artist}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div className=\"w-full\">\r\n          <div className=\"flex items-center border-border border-b px-4 pb-4\">\r\n            <div className=\"flex flex-1 items-center gap-2\">\r\n              <h3 className=\"font-medium text-lg tracking-tight\">Playlist</h3>\r\n              <ListMusicIcon className=\"size-4\" />\r\n            </div>\r\n            <span className=\"text-muted-foreground text-sm\">{`${currentTrackIndex + 1} / ${tracks.length}`}</span>\r\n          </div>\r\n          <ScrollArea className=\"max-h-[200px]\">\r\n            {tracks.map((track, index) => (\r\n              <Button\r\n                key={track.id}\r\n                variant=\"ghost\"\r\n                className={cn(\r\n                  \"h-auto w-full rounded-none px-4 py-3 text-left\",\r\n                  index === currentTrackIndex && \"bg-accent\",\r\n                )}\r\n                onClick={() => onTogglePlayPauseTrack(index)}\r\n                disabled={isLoading}\r\n              >\r\n                {/* biome-ignore lint/performance/noImgElement: dynamic cover URLs from playlist tracks don't work well with Next.js Image optimization */}\r\n                <img\r\n                  src={track.cover}\r\n                  alt={track.title}\r\n                  className=\"aspect-square size-9 rounded object-cover\"\r\n                />\r\n                <div className=\"flex flex-1 flex-col\">\r\n                  <span\r\n                    className={cn(\r\n                      \"font-medium leading-tight\",\r\n                      index === currentTrackIndex && \"text-primary\",\r\n                    )}\r\n                  >\r\n                    {track.title}\r\n                  </span>\r\n                  <span className=\"text-muted-foreground text-sm\">\r\n                    {track.artist}\r\n                  </span>\r\n                </div>\r\n                {index === currentTrackIndex && isLoading ? (\r\n                  <Loader2Icon className=\"size-6 animate-spin text-primary\" />\r\n                ) : index === currentTrackIndex && isPlaying ? (\r\n                  <PauseCircleIcon className=\"size-6 text-primary\" />\r\n                ) : index === currentTrackIndex && !isPlaying ? (\r\n                  <PlayCircleIcon className=\"size-6 text-muted-foreground\" />\r\n                ) : (\r\n                  <PlayCircleIcon className=\"size-6 text-muted-foreground opacity-0 transition-opacity group-hover:opacity-100\" />\r\n                )}\r\n              </Button>\r\n            ))}\r\n          </ScrollArea>\r\n        </div>\r\n        <MediaPlayerControls className=\"relative flex w-full flex-col gap-2.5\">\r\n          <MediaPlayerSeek />\r\n          <div className=\"flex w-full items-center justify-center gap-2\">\r\n            <MediaPlayerTooltip tooltip=\"Previous track\" shortcut=\"B\">\r\n              <Button\r\n                aria-label=\"Previous track\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"size-8\"\r\n                onClick={onPreviousTrack}\r\n                disabled={isLoading}\r\n              >\r\n                <SkipBackIcon />\r\n              </Button>\r\n            </MediaPlayerTooltip>\r\n            <MediaPlayerPlay />\r\n            <MediaPlayerTooltip tooltip=\"Next track\" shortcut=\"N\">\r\n              <Button\r\n                aria-label=\"Next track\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"size-8\"\r\n                onClick={onNextTrack}\r\n                disabled={isLoading}\r\n              >\r\n                <SkipForwardIcon />\r\n              </Button>\r\n            </MediaPlayerTooltip>\r\n            <MediaPlayerTime variant=\"progress\" />\r\n            <MediaPlayerVolume className=\"ml-auto\" />\r\n          </div>\r\n        </MediaPlayerControls>\r\n      </div>\r\n    </MediaPlayer>\r\n  );\r\n}\r\n",
      "type": "registry:example",
      "target": ""
    }
  ],
  "type": "registry:example"
}
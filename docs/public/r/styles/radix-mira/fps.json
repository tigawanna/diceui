{
  "name": "fps",
  "dependencies": [],
  "files": [
    {
      "path": "ui/fps.tsx",
      "content": "\"use client\";\r\n\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst fpsVariants = cva(\r\n  \"z-50 flex shrink-0 items-center gap-2 rounded-sm border bg-background/80 px-3 py-1.5 font-mono text-foreground text-sm backdrop-blur-sm\",\r\n  {\r\n    variants: {\r\n      strategy: {\r\n        fixed: \"fixed\",\r\n        absolute: \"absolute\",\r\n      },\r\n      position: {\r\n        \"top-left\": \"top-4 left-4\",\r\n        \"top-right\": \"top-4 right-4\",\r\n        \"bottom-left\": \"bottom-4 left-4\",\r\n        \"bottom-right\": \"right-4 bottom-4\",\r\n      },\r\n      status: {\r\n        good: \"text-primary\",\r\n        warning: \"text-orange-500\",\r\n        error: \"text-destructive\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      strategy: \"fixed\",\r\n      position: \"top-right\",\r\n      status: \"good\",\r\n    },\r\n  },\r\n);\r\n\r\ninterface FpsProps\r\n  extends React.ComponentProps<\"div\">,\r\n    Omit<VariantProps<typeof fpsVariants>, \"status\"> {\r\n  label?: string;\r\n  updateInterval?: number;\r\n  warningThreshold?: number;\r\n  errorThreshold?: number;\r\n  portalContainer?: Element | DocumentFragment | null;\r\n  enabled?: boolean;\r\n}\r\n\r\nfunction Fps(props: FpsProps) {\r\n  const {\r\n    strategy = \"fixed\",\r\n    position = \"top-right\",\r\n    label,\r\n    updateInterval = 500,\r\n    warningThreshold = 30,\r\n    errorThreshold = 20,\r\n    portalContainer: portalContainerProp,\r\n    enabled = true,\r\n    className,\r\n    ...fpsProps\r\n  } = props;\r\n\r\n  const [mounted, setMounted] = React.useState(false);\r\n  const [fps, setFps] = React.useState(0);\r\n  const frameCountRef = React.useRef(0);\r\n  const lastTimeRef = React.useRef(performance.now());\r\n  const animationFrameRef = React.useRef<number | null>(null);\r\n  const updateTimeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(\r\n    null,\r\n  );\r\n\r\n  React.useLayoutEffect(() => setMounted(true), []);\r\n\r\n  const status = React.useMemo(() => {\r\n    if (fps < errorThreshold) return \"error\";\r\n    if (fps < warningThreshold) return \"warning\";\r\n    return \"good\";\r\n  }, [fps, errorThreshold, warningThreshold]);\r\n\r\n  React.useEffect(() => {\r\n    if (!enabled || typeof window === \"undefined\") return;\r\n\r\n    function measureFps() {\r\n      const now = performance.now();\r\n      const delta = now - lastTimeRef.current;\r\n      frameCountRef.current += 1;\r\n\r\n      if (delta >= updateInterval) {\r\n        const currentFps = Math.round((frameCountRef.current * 1000) / delta);\r\n        setFps(currentFps);\r\n        frameCountRef.current = 0;\r\n        lastTimeRef.current = now;\r\n      }\r\n\r\n      animationFrameRef.current = requestAnimationFrame(measureFps);\r\n    }\r\n\r\n    animationFrameRef.current = requestAnimationFrame(measureFps);\r\n\r\n    return () => {\r\n      if (animationFrameRef.current !== null) {\r\n        cancelAnimationFrame(animationFrameRef.current);\r\n      }\r\n      if (updateTimeoutRef.current !== null) {\r\n        clearTimeout(updateTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [enabled, updateInterval]);\r\n\r\n  if (!enabled) return null;\r\n\r\n  const portalContainer =\r\n    strategy === \"absolute\"\r\n      ? null\r\n      : (portalContainerProp ?? (mounted ? globalThis.document?.body : null));\r\n\r\n  const Comp = (\r\n    <div\r\n      aria-hidden=\"true\"\r\n      data-slot=\"fps\"\r\n      {...fpsProps}\r\n      className={cn(fpsVariants({ strategy, position, status }), className)}\r\n    >\r\n      {label && (\r\n        <span data-slot=\"fps-label\" className=\"text-muted-foreground\">\r\n          {label}:\r\n        </span>\r\n      )}\r\n      <span data-slot=\"fps-value\">{fps}</span>\r\n    </div>\r\n  );\r\n\r\n  return portalContainer ? ReactDOM.createPortal(Comp, portalContainer) : Comp;\r\n}\r\n\r\nexport { Fps };\r\n",
      "type": "registry:ui",
      "target": ""
    }
  ],
  "type": "registry:ui"
}
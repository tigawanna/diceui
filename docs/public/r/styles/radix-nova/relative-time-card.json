{
  "name": "relative-time-card",
  "dependencies": [
    "radix-ui"
  ],
  "registryDependencies": [
    "hover-card"
  ],
  "files": [
    {
      "path": "ui/relative-time-card.tsx",
      "content": "\"use client\";\r\n\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\nimport {\r\n  type HoverCard as HoverCardPrimitive,\r\n  Slot as SlotPrimitive,\r\n} from \"radix-ui\";\r\nimport * as React from \"react\";\r\nimport {\r\n  HoverCard,\r\n  HoverCardContent,\r\n  HoverCardTrigger,\r\n} from \"@/components/ui/hover-card\";\r\n\r\ntype HoverCardProps = React.ComponentProps<typeof HoverCardPrimitive.Root>;\r\ntype HoverCardContentProps = React.ComponentProps<\r\n  typeof HoverCardPrimitive.Content\r\n>;\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction pluralize(n: number, word: string) {\r\n  return `${n} ${word}${n === 1 ? \"\" : \"s\"}`;\r\n}\r\n\r\nfunction formatRelativeTime(date: Date): string {\r\n  const now = new Date();\r\n  const diff = now.getTime() - date.getTime();\r\n  const isInFuture = diff < 0;\r\n  const absDiff = Math.abs(diff);\r\n\r\n  const seconds = Math.floor(absDiff / 1000);\r\n  const minutes = Math.floor(seconds / 60);\r\n  const hours = Math.floor(minutes / 60);\r\n  const days = Math.floor(hours / 24);\r\n\r\n  if (seconds < 5) return \"just now\";\r\n\r\n  if (isInFuture) {\r\n    if (seconds < 60) return `in ${pluralize(seconds, \"second\")}`;\r\n    if (minutes < 60) return `in ${pluralize(minutes, \"minute\")}`;\r\n    if (hours < 24) return `in ${pluralize(hours, \"hour\")}`;\r\n    if (days < 7) return `in ${pluralize(days, \"day\")}`;\r\n    return date.toLocaleDateString();\r\n  }\r\n\r\n  if (seconds < 60) return `${pluralize(seconds, \"second\")} ago`;\r\n  if (minutes < 60)\r\n    return `${pluralize(minutes, \"minute\")} ${pluralize(seconds % 60, \"second\")} ago`;\r\n  if (hours < 24) return `${pluralize(hours, \"hour\")} ago`;\r\n  if (days < 7) return `${pluralize(days, \"day\")} ago`;\r\n  return date.toLocaleDateString();\r\n}\r\n\r\ninterface TimezoneCardProps extends React.ComponentProps<\"div\"> {\r\n  date: Date;\r\n  timezone?: string;\r\n}\r\n\r\nfunction TimezoneCard(props: TimezoneCardProps) {\r\n  const { date, timezone, ...cardProps } = props;\r\n\r\n  const locale = React.useMemo(\r\n    () => Intl.DateTimeFormat().resolvedOptions().locale,\r\n    [],\r\n  );\r\n\r\n  const timezoneName = React.useMemo(\r\n    () =>\r\n      timezone ??\r\n      new Intl.DateTimeFormat(locale, { timeZoneName: \"shortOffset\" })\r\n        .formatToParts(date)\r\n        .find((part) => part.type === \"timeZoneName\")?.value,\r\n    [date, timezone, locale],\r\n  );\r\n\r\n  const { formattedDate, formattedTime } = React.useMemo(\r\n    () => ({\r\n      formattedDate: new Intl.DateTimeFormat(locale, {\r\n        month: \"long\",\r\n        day: \"numeric\",\r\n        year: \"numeric\",\r\n        timeZone: timezone,\r\n      }).format(date),\r\n      formattedTime: new Intl.DateTimeFormat(locale, {\r\n        hour: \"2-digit\",\r\n        minute: \"2-digit\",\r\n        second: \"2-digit\",\r\n        hour12: true,\r\n        timeZone: timezone,\r\n      }).format(date),\r\n    }),\r\n    [date, timezone, locale],\r\n  );\r\n\r\n  return (\r\n    <div\r\n      role=\"region\"\r\n      aria-label={`Time in ${timezoneName}: ${formattedDate} ${formattedTime}`}\r\n      {...cardProps}\r\n      className=\"flex items-center justify-between gap-2 text-muted-foreground text-sm\"\r\n    >\r\n      <span className=\"w-fit rounded bg-accent px-1 font-medium text-xs\">\r\n        {timezoneName}\r\n      </span>\r\n      <div className=\"flex items-center gap-2\">\r\n        <time dateTime={date.toISOString()}>{formattedDate}</time>\r\n        <time className=\"tabular-nums\" dateTime={date.toISOString()}>\r\n          {formattedTime}\r\n        </time>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst triggerVariants = cva(\r\n  \"inline-flex w-fit items-center justify-center text-foreground/70 text-sm transition-colors hover:text-foreground/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"\",\r\n        muted: \"text-foreground/50 hover:text-foreground/70\",\r\n        ghost: \"hover:underline\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\ninterface RelativeTimeCardProps\r\n  extends React.ComponentProps<\"button\">,\r\n    HoverCardProps,\r\n    Pick<\r\n      HoverCardContentProps,\r\n      | \"align\"\r\n      | \"side\"\r\n      | \"alignOffset\"\r\n      | \"sideOffset\"\r\n      | \"avoidCollisions\"\r\n      | \"collisionBoundary\"\r\n      | \"collisionPadding\"\r\n      | \"asChild\"\r\n    >,\r\n    VariantProps<typeof triggerVariants> {\r\n  date: Date | string | number;\r\n  timezones?: string[];\r\n  updateInterval?: number;\r\n}\r\n\r\nfunction RelativeTimeCard(props: RelativeTimeCardProps) {\r\n  const {\r\n    date: dateProp,\r\n    variant,\r\n    timezones = [\"UTC\"],\r\n    open,\r\n    defaultOpen,\r\n    onOpenChange,\r\n    openDelay = 500,\r\n    closeDelay = 300,\r\n    align,\r\n    side,\r\n    alignOffset,\r\n    sideOffset,\r\n    avoidCollisions,\r\n    collisionBoundary,\r\n    collisionPadding,\r\n    updateInterval = 1000,\r\n    asChild,\r\n    children,\r\n    className,\r\n    ...triggerProps\r\n  } = props;\r\n\r\n  const date = React.useMemo(\r\n    () => (dateProp instanceof Date ? dateProp : new Date(dateProp)),\r\n    [dateProp],\r\n  );\r\n\r\n  const locale = React.useMemo(\r\n    () => Intl.DateTimeFormat().resolvedOptions().locale,\r\n    [],\r\n  );\r\n\r\n  const [formattedTime, setFormattedTime] = React.useState<string>(() =>\r\n    date.toLocaleDateString(),\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    setFormattedTime(formatRelativeTime(date));\r\n    const timer = setInterval(() => {\r\n      setFormattedTime(formatRelativeTime(date));\r\n    }, updateInterval);\r\n\r\n    return () => clearInterval(timer);\r\n  }, [date, updateInterval]);\r\n\r\n  const TriggerPrimitive = asChild ? SlotPrimitive.Slot : \"button\";\r\n\r\n  return (\r\n    <HoverCard\r\n      open={open}\r\n      defaultOpen={defaultOpen}\r\n      onOpenChange={onOpenChange}\r\n      openDelay={openDelay}\r\n      closeDelay={closeDelay}\r\n    >\r\n      <HoverCardTrigger asChild>\r\n        <TriggerPrimitive\r\n          {...triggerProps}\r\n          className={cn(triggerVariants({ variant, className }))}\r\n        >\r\n          {children ?? (\r\n            <time dateTime={date.toISOString()} suppressHydrationWarning>\r\n              {new Intl.DateTimeFormat(locale, {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n                year: \"numeric\",\r\n                hour: \"2-digit\",\r\n                minute: \"2-digit\",\r\n              }).format(date)}\r\n            </time>\r\n          )}\r\n        </TriggerPrimitive>\r\n      </HoverCardTrigger>\r\n      <HoverCardContent\r\n        side={side}\r\n        align={align}\r\n        sideOffset={sideOffset}\r\n        alignOffset={alignOffset}\r\n        avoidCollisions={avoidCollisions}\r\n        collisionBoundary={collisionBoundary}\r\n        collisionPadding={collisionPadding}\r\n        className=\"flex w-full max-w-[420px] flex-col gap-2 p-3\"\r\n      >\r\n        <time\r\n          dateTime={date.toISOString()}\r\n          className=\"text-muted-foreground text-sm\"\r\n        >\r\n          {formattedTime}\r\n        </time>\r\n        <div role=\"list\" className=\"flex flex-col gap-1\">\r\n          {timezones.map((timezone) => (\r\n            <TimezoneCard\r\n              key={timezone}\r\n              role=\"listitem\"\r\n              date={date}\r\n              timezone={timezone}\r\n            />\r\n          ))}\r\n          <TimezoneCard role=\"listitem\" date={date} />\r\n        </div>\r\n      </HoverCardContent>\r\n    </HoverCard>\r\n  );\r\n}\r\n\r\nexport { RelativeTimeCard };\r\n",
      "type": "registry:ui",
      "target": ""
    }
  ],
  "type": "registry:ui"
}